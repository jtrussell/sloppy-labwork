from django.urls import path, include
from django.views.generic.base import RedirectView
from common.urls import urlpatterns as common_urlpatterns
from . import views

urlpatterns = [
    path('', RedirectView.as_view(url='@me', permanent=False)),
    path('@me/', views.my_keychain, name='pmc-my-keychain'),
    path('@me/manage/', views.manage_my_pmc_profile,
         name='pmc-my-keychain-manage'),
    path('@me/manage/avatar/', views.change_avatar, name='pmc-manage-avatar'),
    path('@me/manage/background/', views.change_background,
         name='pmc-manage-background'),
    path('@me/manage/mv-connect/', views.set_master_vault_data,
         name='pmc-manage-mv-connect'),
    path('@me/results/', views.my_results, name='pmc-my-results'),

    path('users/<username>/', views.user_profile, name='pmc-user-profile'),

    path('pg/<slug:slug>/', views.PlaygroupDetail.as_view(), name='pmc-pg-detail'),
    path('pg/<slug:slug>/join/<int:pk>/manage/',
         views.playgroup_join_request_manage, name='pmc-pg-join-manage'),
    path('pg/<slug:slug>/join/', views.playgroup_join_request, name='pmc-pg-join'),
    path('pg/<slug:slug>/manage/', views.manage_playgroup, name='pmc-pg-manage'),
    path('pg/<slug:slug>/venues/add/', views.add_playgroup_venue, name='pmc-pg-venue-add'),
    path('pg/<slug:slug>/venues/<int:venue_id>/remove/', views.remove_playgroup_venue, name='pmc-pg-venue-remove'),
    path('pg/<slug:slug>/venues/set-primary/', views.set_playgroup_primary_venue, name='pmc-pg-venue-set-primary'),
    path('pg/<slug:slug>/@me/manage/',
         views.manage_my_playgroup_profile, name='pmc-my-pg-manage'),
    path('pg/<slug:slug>/members/',
         views.PlaygroupMembersList.as_view(), name='pmc-pg-members'),
    path('pg/<slug:slug>/members/<username>/manage',
         views.playgroup_member_manage, name='pmc-pg-member-manage'),
    path('pg/<slug:slug>/members/<username>/',
         views.playgroup_member_detail, name='pmc-pg-member-detail'),
    path('pg/<slug:slug>/add-member-by-qrcode/',
         views.add_pg_member_by_qrcode, name='pmc-pg-add-member-by-qrcode'),
    path('pg/<slug:slug>/add-member-by-username/',
         views.add_pg_member_by_username, name='pmc-pg-add-member-by-username'),
    path('pg/<slug:slug>/leaderboard/',
         views.playgroup_leaderboard, name='pmc-pg-leaderboard'),
    path('pg/<slug:slug>/leaderboard/<int:pk>/',
         views.playgroup_leaderboard, name='pmc-pg-leaderboard'),
    path('pg/<slug:slug>/events/',
         views.PlaygroupEventsList.as_view(), name='pmc-pg-events'),
    path('pg/<slug:slug>/events/new/',
         views.submit_event_results, name='pmc-pg-events-new'),
    path('pg/<slug:slug>/event-results/<int:pk>/',
         views.manage_event_result, name='pmc-pg-manage-result'),
    path('pg/<slug:slug>/events/csv-template/',
         views.get_result_submission_template, name='pmc-pg-events-csv-template'),
    path('events/<int:pk>/', views.event_detail_generic, name='pmc-event-detail'),
    path('pg/<slug:slug>/events/<int:pk>/',
         views.EventDetail.as_view(), name='pmc-pg-event-detail'),
    path('pg/<slug:slug>/events/<int:pk>/manage/',
         views.manage_event, name='pmc-pg-event-manage'),
    path('pg/<slug:slug>/events/<int:pk>/results/',
         views.add_event_result, name='pmc-pg-add-event-result'),
    path('pg/<slug:slug>/events/<int:pk>/delete/',
         views.delete_event, name='pmc-delete-event'),
    path('pg/<slug:slug>/events/<int:pk>/points/',
         views.assign_event_points, name='pmc-event-assign-points'),
    path('pg/<slug:slug>/results/<int:pk>',
         views.result_detail, name='pmc-result-detail'),
    path('leaderboard/', views.global_leaderboard, name='pmc-leaderboard'),
    path('leaderboard/<int:pk>/', views.global_leaderboard, name='pmc-leaderboard'),
    path('typography/', views.typography),
    path('about/', views.about, name='pmc-about'),
    path('about-ranking-points/', views.about_ranking_points,
         name='pmc-about-ranking-points'),
    path('attributions/', views.attributions, name='pmc-attributions'),
    path('refresh-leaderboard/<int:pk>/', views.refresh_leaderboard),

    path('@me/awards/trophies/<int:pk>/', views.my_trophy_detail,
         name='pmc-my-trophy-detail'),
    path('@me/awards/achievements/<int:pk>/', views.my_achievement_detail,
         name='pmc-my-achievement-detail'),
    path('@me/awards/badges/<int:pk>/', views.my_badge_detail,
         name='pmc-my-badge-detail'),
    path('@me/awards/', views.my_awards, name='pmc-my-awards'),
    path('api/trophies/', views.list_refreshable_trophies),
    path('api/achievements/', views.list_refreshable_achievements),
    path('api/trophies/<pmc_id>/refresh/', views.refresh_trophy),
    path('api/achievements/<pmc_id>/refresh/', views.refresh_achievement),
    path('refresh-trophies/', views.refresh_trophies),
    path('refresh-achievements/', views.refresh_achievements),
    path('refresh-badges/', views.refresh_badges),
    path('hydrate-result-decks/', views.hydrate_result_decks),

    # Common to all hosts
    path('accounts/', include('allauth.urls')),
]

urlpatterns += common_urlpatterns
