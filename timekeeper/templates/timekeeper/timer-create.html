{% extends base_template %}
{% load static %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'timekeeper/timer.css' %}">
{% endblock %}

{% block content %}
<h1>Create Timer</h1>

<section>
    <form method="post" id="timer-create-form" class="form-wide" hx-post="{% url 'timekeeper:timer_create' %}" hx-target="#timer-result" hx-swap="innerHTML">
        {% csrf_token %}
        <p>
            <label for="id_name">Timer Name</label>
            {{ form.name }}
        </p>
        <p>
            <label for="id_minutes">Duration (minutes)</label>
            {{ form.minutes }}
        </p>
        <button type="submit" class="button button-primary">Create Timer</button>
    </form>
</section>

<section id="timer-result">
</section>

{% if my_timers %}
<section>
    <h2>My Timers</h2>
    <table class="u-full-width">
        <thead>
            <tr>
                <th>Name</th>
                <th>Created</th>
                <th>State</th>
            </tr>
        </thead>
        <tbody>
            {% for timer in my_timers %}
            <tr>
                <td><a href="{% url 'timekeeper:timer_detail' timer.code %}">{{ timer.name }}</a></td>
                <td>{{ timer.created_on|date:"M j, Y g:i A" }}</td>
                <td>{{ timer.get_state.value|capfirst }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% if my_timers.has_other_pages %}
    <nav class="pagination">
        {% if my_timers.has_previous %}
            <a href="?page={{ my_timers.previous_page_number }}">&laquo; Previous</a>
        {% endif %}
        <span class="text-muted">
            Page {{ my_timers.number }} of {{ my_timers.paginator.num_pages }}
        </span>
        {% if my_timers.has_next %}
            <a href="?page={{ my_timers.next_page_number }}">Next &raquo;</a>
        {% endif %}
    </nav>
    {% endif %}
</section>
{% endif %}
{% endblock %}

{% block extra_body %}
<script src="{% static 'timekeeper/timer.js' %}"></script>
{% endblock %}
