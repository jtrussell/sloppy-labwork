{% extends "tourney/_base.html" %}

{% block content %}
<h1>My Tournaments</h1>

<div class="card">
    <h2>Tournaments I Admin</h2>
    
    <div style="margin-bottom: 2rem;">
        <a href="{% url 'tourney-create-tournament' %}" class="button button-primary">Create Tournament</a>
    </div>
    
    {% if admin_tournaments %}
        <table>
            <thead>
                <tr>
                    <th>Tournament</th>
                    <th>Created</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for tournament in admin_tournaments %}
                <tr>
                    <td>
                        <a href="{% url 'tourney-detail-home' tournament.id %}">
                            {{ tournament.name }}
                        </a>
                    </td>
                    <td>{{ tournament.created_on|date:"M d, Y" }}</td>
                    <td>
                        {% if tournament.is_accepting_registrations %}
                            <span class="badge success">Open Registration</span>
                        {% else %}
                            <span class="badge">Closed</span>
                        {% endif %}
                    </td>
                    <td>
                        <a href="{% url 'tourney-edit-tournament' tournament.id %}">Edit</a>
                        <a href="{% url 'tourney-copy-tournament' tournament.id %}">Copy</a>
                        <a href="{% url 'tourney-manage-players' tournament.id %}">Manage Players</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        {% if admin_tournaments.has_other_pages %}
            <div class="pagination">
                {% if admin_tournaments.has_previous %}
                    <a href="?admin_page={{ admin_tournaments.previous_page_number }}">&laquo; previous</a>
                {% endif %}
                
                <span>Page {{ admin_tournaments.number }} of {{ admin_tournaments.paginator.num_pages }}</span>
                
                {% if admin_tournaments.has_next %}
                    <a href="?admin_page={{ admin_tournaments.next_page_number }}">next &raquo;</a>
                {% endif %}
            </div>
        {% endif %}
    {% else %}
        <p>You haven't created any tournaments yet.</p>
    {% endif %}
</div>

<div class="card">
    <h2>Tournaments I'm Playing In</h2>
    {% if player_tournaments %}
        <table>
            <thead>
                <tr>
                    <th>Tournament</th>
                    <th>Created</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for tournament in player_tournaments %}
                <tr>
                    <td>
                        <a href="{% url 'tourney-detail-home' tournament.id %}">
                            {{ tournament.name }}
                        </a>
                    </td>
                    <td>{{ tournament.created_on|date:"M d, Y" }}</td>
                    <td>
                        {% if tournament.is_accepting_registrations %}
                            <span class="badge success">Open Registration</span>
                        {% else %}
                            <span class="badge">In Progress</span>
                        {% endif %}
                    </td>
                    <td>
                        <a href="{% url 'tourney-detail-home' tournament.id %}">View</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        {% if player_tournaments.has_other_pages %}
            <div class="pagination">
                {% if player_tournaments.has_previous %}
                    <a href="?player_page={{ player_tournaments.previous_page_number }}">&laquo; previous</a>
                {% endif %}
                
                <span>Page {{ player_tournaments.number }} of {{ player_tournaments.paginator.num_pages }}</span>
                
                {% if player_tournaments.has_next %}
                    <a href="?player_page={{ player_tournaments.next_page_number }}">next &raquo;</a>
                {% endif %}
            </div>
        {% endif %}
    {% else %}
        <p>You're not registered for any tournaments.</p>
    {% endif %}
</div>
{% endblock %}